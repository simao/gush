# Gush

[![Build Status](https://travis-ci.org/simao/gush.png?branch=master)](https://travis-ci.org/simao/gush)

Gush transforms your mysql database in a stream of data.

Gush connects to a mysql master and generates events for each sql
statement using [Esper](http://esper.codehaus.org/).

This way you can analyze your data as a real time event stream using
sql-like queries.

Gush can also react on events generated by Esper Complex Event
Processing queries and send new events to statsd. More observers can
be easily added to implement new behaviors.

# Examples

Gush's allows you to write queries like:

```sql
-- new record inserted in table `bookings`
SELECT * FROM BinlogStreamEvent WHERE tableName='bookings`;
```

```sql
-- number of bookings in the last x seconds
SELECT count(*) AS count FROM BinlogStreamEvent.win:time_batch($x second)
WHERE tableName='bookings';
```

```sql
-- average net revenue of last x seconds
SELECT avg(asFloat('net_revenue')) as avg_rev
FROM BinlogStreamEvent.win:time_batch($x second)
WHERE tableName='bookings;
```

And write
[Observers](https://rxscala.github.io/scaladoc/index.html#rx.lang.scala.Observer)
that will act on the values returned from these queries.

You can then threat your data as queriable real time stream. 

# Running

You will need to modify the Esper queries to suit your data before
actually running `gush`. Check the
[EventStreamListeners.scala](https://github.com/simao/gush/blob/master/src/main/scala/esper/EventStreamListeners.scala)
file.

1. `git clone git@github.com:simao/gush.git`
2. `cp gush.config.yml.sample gush.config.yml`
3. Open `gush.config.yml` and adjust values
4. `sbt run`

# Unsupported features

- No support for `UPDATE statements`. This will be implemented soon.
- No support for `ON DUPLICATE KEY` statements. No plans to support this. Patches welcome!

# Contributing

Gush written in Scala and uses RxScala and Esper

No pull request is too small, documentation improvements also very
welcome!

# Author

- Sim√£o Mata - [simao.io](https://simao.io)
